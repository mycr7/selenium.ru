---
layout: page
title: Устанавливаем свой маленький локальный веб-сервер
redirect_from: /articles/80-installing-wamp-server.html
date: 2013-02-18 14:40:14.000000000 +04:00
author: Алексей Баранцев
teaser: В последнее время с WAMP Server происходят всякие неприятности -- периодическая недоступность сайта, неудачные настройки по-умолчанию, поэтому мы решили перевести все наши учебные курсы на использование XAMPP. Про него [написана новая инструкция](articles/136-installing-xampp.html), тоже с картинками, а эту инструкцию предлагается считать устаревшей (хотя снимать с публикации мы её не будем, оставим для истории, ну и может быть ещё кому-нибудь пригодится).
category: Статьи
---
<p><em>В последнее время с WAMP Server происходят всякие неприятности -- периодическая недоступность сайта, неудачные настройки по-умолчанию, поэтому <strong>мы решили</strong> <strong>перевести все наши учебные курсы на использование XAMPP</strong>. Про него <a href="articles/136-installing-xampp.html"><strong>написана новая инструкция</strong></a><a href="articles/136-installing-xampp.html"></a>, тоже с картинками, а <strong>эту инструкцию предлагается считать устаревшей</strong> (хотя снимать с публикации мы её не будем, оставим для истории, ну и может быть ещё кому-нибудь пригодится).</em></p>
<p>Нередко возникает ситуация, когда вам понадобился ваш личный веб-сервер для тестовых целей. Например, вы выбираете баг-трекер, но публичной демо-версии нет – надо его куда-нибудь установить, чтобы попробовать. Или вы хотите научиться пользоваться каким-нибудь инструментом для нагрузочного тестирования – не стоит сразу "натравливать" его даже на общедоступный тестовый стенд, не говоря уж о продуктивной системе, этим вы создадите массу проблем окружающим.</p>
<p>На всех наших тренингах с домашними заданиями (<a href="http://software-testing.ru/trainings/schedule?&amp;task=3&amp;cid=1">программирование для тестировщиков</a>, курсы по Selenium <a href="http://software-testing.ru/trainings/schedule?&amp;task=3&amp;cid=185">разного</a> <a href="http://software-testing.ru/trainings/schedule?&amp;task=3&amp;cid=186">уровня</a> <a href="http://software-testing.ru/trainings/schedule?task=3&amp;cid=187">сложности</a>, курсы по тестированию <a href="http://software-testing.ru/trainings/schedule?task=3&amp;cid=19">производительности</a> и <a href="http://software-testing.ru/trainings/schedule?task=3&amp;cid=126">защищенности</a> веб-приложений) самым первым заданием для учеников является подготовка учебного тестового стенда. Для этой цели я подготовил инструкцию, расширенный вариант которой (с картинками!) представляю вашему вниманию.</p><p>Конечно, платформ для разработки веб-приложений существует немало – ASP.Net, Ruby on Rails, Java EE и другие, для разработки используются самые разные языки программирования, и в одной инструкции совершенно невозможно охватить всё это разнообразие. Поэтому я решил ограничиться наиболее широкораспространённым случаем:</p>
<ul>
<li>сервер предназначен для приложений, разработанных на PHP,</li>
<li>устанавливается на операционную систему Windows, как наиболее часто встречающуюся на рабочих станциях.</li>
</ul>
<p>Типовая инфраструктура для развертывания современных веб-приложений включает в себя как минимум три составных элемента:</p>
<ul>
<li>собственно платформа разработки, условно говоря -- интерпретатор языка программирования (PHP, Python, Ruby, .Net, Java, ...),</li>
<li>база данных, в которой приложение хранит данные (MySQL, Postgress, MS SQL Server, Oracle, ...),</li>
<li>веб-сервер, который принимает запросы от клиентов и перенаправляет их приложению (Apache, Nginx, IIS, ...)</li>
</ul>
<p>Для каждого элемента инфраструктуры есть выбор из целого ряда альтернатив, и комбинировать их можно различными способами.</p>
<p>Но есть исторически сложившиеся популярные связки, из которых особо можно выделить две комбинации: Apache + MySQL + PHP и Nginx + MySQL + PHP. Для них существуют готовые "инсталляционные пакеты", которые позволяют устанавливать компоненты не по отдельности, а все разом, что весьма удобно для "локального веб-сервера" -- быстро и просто.</p>
<p>Из множества подобных пакетов я выбрал <a href="http://www.wampserver.com/">WampServer</a>, потому что он наиболее тесно интегрируется с операционной системой Windows -- "нативный" инсталлятор, компоненты устанавливаются как сервисы Windows, удобный механизм остановки, запуска и конфигурирования через меню в трее.</p>
<h2>Часть 1: делай раз, делай два, делай три!</h2>
<p>Итак, устанавливаем и запускаем WampServer.</p>
<p><strong>1. Отправляемся на сайт <a href="http://www.wampserver.com/">http://www.wampserver.com/</a> , чтобы загрузить дистрибутив.</strong> Сайт неожиданно оказывается на французском языке, но к счастью имеется не только английская, но даже русская версия!</p>
<p><img src="images/articles/barancev/wampserver/wamp_download_1.png" border="0" /></p>
<p><strong>2. Выбираем, какой из дистрибутивов загрузить.</strong> Обратите внимание на битность (32 или 64) -- она должна совпадать с битностью вашей операционной системы.</p>
<p><img src="images/articles/barancev/wampserver/wamp_download_2_1.png" border="0" width="630" /></p>
<p><strong>3. На следующем шаге не пропустите важную информацию</strong> -- для работы WampServer нужно установить Visual C++ 2010 SP1 Redistributable Package, то есть набор дополнительных библиотек от компании Microsoft. Опять таки выбирайте ту версию, которая соответствует битности вашей системы.</p>
<p><img src="images/articles/barancev/wampserver/wamp_download_3.png" border="0" width="632" height="269" style="border: 1px solid black;" /></p>
<p>В итоге вы должны загрузить два файла:</p>
<ul>
<li>Visual C++ 2010 SP1 Redistributable Package нужной битности (32 или 64),</li>
<li>инсталлятор WampServer с именем типа такого: Wampserver2.4-x64.exe</li>
</ul>
<p><strong>4. Инсталлируем последовательно сначала Visual C++ 2010 SP1 Redistributable Package, затем WampServer.</strong></p>
<p>Здесь никаких картинок не будет, потому что процедура инсталляции стандартная – достаточно просто всё время нажимать кнопку Next в визарде. Конечно, при желании вы можете изменить директорию, в которую будет проинсталлирован WAMP Server, но в дальнейшем будет предполагаться, что он установлен в директорию, предлагаемую по умолчанию, то есть C:\wamp</p>
<p><strong>5. WampServer установлен, идём в меню Start (Пуск), ищем там папку WampServer, в ней пункт start WampServer, и запускаем его.</strong></p>
<p><img src="images/articles/barancev/wampserver/wamp_startmenu.png" border="0" alt="" /></p>
<p><strong>6. Вместе с самим сервером запускается WampManager</strong>, который сидит в трее (области уведомлений) и позволяет контролировать текущее состояние сервера, а также выполнять с ним различные манипуляции. Появившаяся в трее иконка WampManager поначалу имеет красный цвет, но постепенно становится оранжевой, а затем зелёной. Если это произошло -- значит, всё отлично, сервер успешно стартовал.</p>
<p><img src="images/articles/barancev/wampserver/wamp_tray.png" border="0" alt="" /></p>
<p><strong>7. Осталось только зайти браузером по адресу <a href="http://localhost/">http://localhost/</a> и убедиться, что сервер действительно работает!</strong></p>
<p><img src="images/articles/barancev/wampserver/wamp_browser.png" border="0" alt="" width="385" height="240" /></p>
<p>Теперь можно туда устанавливать веб-приложения, но это уже другая история.</p>
<p>А мы не будем спешить, оглянемся назад и рассмотрим ситуации, когда не всё заработало с первой попытки. Вся оставшаяся часть статьи посвящена решению различных проблем с запуском и настройкой WampServer, если у вас всё запустилось и в браузере открылась приветственная страница WampServer -- дальше можно не читать :)</p>
<h2>Часть 2. Что-то не получилось…</h2>
<p>Что может помешать серверу нормально работать?</p>
<p>Вариантов всего три:<br />1. сервер неправильно установился<br />2. правильно установился, но не запускается какой-то из компонентов<br />3. всё запустилось, но сервер недоступен из браузера</p>
<p>Сейчас мы последовательно рассмотрим симптомы различных проблемных ситуаций, и для каждой из них будет указана причина проблемы и способ её устранения.</p>
<p><strong>F1. WampServer не запускается, либо запускается, но любые действия с WampManager приводят к появлению системного сообщения об ошибке</strong> примерно такого вида:</p>
<p>Картинка - диалог ошибка (поискать в форуме)</p>
<p>Это означает, что вы невнимательно прочитали пункт 3 и забыли установить Visual C++ 2010 SP1 Redistributable Package, либо установили, но не той битности. Для надёжности на 64-битную систему можно установить оба (и 32-битный, и 64-битный).</p>
<p>После установки Visual C++ 2010 SP1 Redistributable Package проблема должна исчезнуть, но возможно потребуется перезапуск WampServer.</p>
<p><strong>F2. WampServer вроде бы запустился, но иконка осталась красной, либо стала оранжевой, а зелёной не становится.</strong></p>
<p>WampServer устанавливает в систему два сервиса -- wampapache и wampmysqld.</p>
<p><img src="images/articles/barancev/wampserver/wamp_services.png" border="0" alt="" /></p>
<p>Зелёная иконка в трее означает, что они оба запущены, оранжевая -- работает только какой-то один из двух, красная -- оба сервиса остановлены.</p>
<p><img src="images/articles/barancev/wampserver/wamp_tray_failed.png" border="0" alt="" /></p>
<p>Почему какой-то из этих сервисов может не стартовать? У этого явления может быть две причины</p>
<ul>
<li><span style="line-height: 1.3em;">"неправильно установилось", либо</span></li>
<li><span style="line-height: 1.3em;"> "что-то мешает запустить".</span></li>
</ul>
<p><strong>Против "неправильно установилось" есть только один способ борьбы -- установить заново.</strong> Но для этого не нужно снова прогонять весь визард-инсталлятор. Обычно просто при установке неудачно инсталлируются сервисы Windows. Поэтому WampManager (который сидит в трее) имеет специальные команды для удаления и повторной установки этих сервисов:</p>
<p><img src="images/articles/barancev/wampserver/wamp_install_service.png" border="0" alt="" /></p>
<p>Более того, чаще всего неудачно устанавливается сервис apache, потому обычно достаточно обновить его. Сначала удаляем сервис, потом повторно его инсталлируем. После чего останавливаем все сервисы WampServer и вновь запускаем их:</p>
<p><img src="images/articles/barancev/wampserver/wamp_restart.png" border="0" alt="" /></p>
<p><strong>Если эти манипуляции не помогли устранить проблему, значит, причина в другом -- "что-то мешает запустить сервис".</strong> Какое-то другое приложение заняло ценный ресурс. И этот ресурс -- сетевой порт.</p>
<p>Mysql использует порт 3306, веб-сервер Apache использует порт 80. Оба эти порта должны быть свободны, иначе соответствующий компонент не запустится.</p>
<p>Маловероятно, что какое-то приложение займёт порт 3306, если только на вашем компьютере не установлен ещё один экземпляр Mysql. А вот порт 80 запросто может быть занят.</p>
<p><strong>Как узнать, какое приложение заняло нужный порт?</strong></p>
<p>Способ первый -- через консоль с использованием утилиты <a href="http://ru.wikipedia.org/wiki/Netstat">netstat</a>.</p>
<p>Запускаем консоль и в ней выполняем команду netstat -ao | find /i "listening"</p>
<p>Во второй колонке ищем 0.0.0.0:80 -- и в последней колонке той же строки будет указан идентификатор процесса, который занимает 80-й порт.</p>
<p><img src="images/articles/barancev/wampserver/netstat.png" border="0" alt="" width="595" height="301" /></p>
<p>Затем запускаем менеджер процессов, в нём делаем видимой колонку, в которой показываются идентификаторы процессов, и ищем процесс с известным нам идентификатором.</p>
<p><img src="images/articles/barancev/wampserver/task_manager_1.png" border="0" alt="" /></p>
<p><img src="images/articles/barancev/wampserver/task_manager_2.png" border="0" alt="" /></p>
<p><img src="images/articles/barancev/wampserver/task_manager_3.png" border="0" alt="" /></p>
<p>Способ второй -- с использованием утилиты <a href="http://technet.microsoft.com/ru-ru/sysinternals/bb897437.aspx">Sysinternals TCPView</a>.</p>
<p>Это, в общем, то же самое, но в более удобной форме -- с использованием графического, а не консольного интерфейса.</p>
<p><img src="images/articles/barancev/wampserver/tcpview.png" border="0" alt="" /></p>
<p>После того, как мешающее приложение обнаружено, нужно принять решение, как разрешить конфликт -- либо перенастроить это приложение, чтобы оно не использовало порт 80, либо перенастроить WampServer на какой-нибудь другой, никем не занятый, порт.</p>
<p>Если порт 80 занял какой-то другой веб-сервер (IIS, другой ранее установленный apache) -- подумайте, нужен ли он вам, можно ли его остановить, и остановите.</p>
<p>Как это ни странно звучит, порт 80 часто занимает Skype (именно это можно видеть выше на скриншотах), причём этот порт ему обычно бывает совершенно не нужен. Идём в настройки Skype, отключаем, после чего перезапускаем скайп -- и порт свободен.</p>
<p><img src="images/articles/barancev/wampserver/skype_settings.png" border="0" alt="" width="590" height="504" /></p>
<p><strong>Если вы не хотите или не можете перенастроить мешающее приложение -- не проблема, в этом случае можно изменить настройки WampServer.</strong></p>
<p>Нажимаем в трее на иконку WampManager, идём в меню Apache и выбираем пункт httpd.conf -- конфигурационный файл веб-сервера открывается на редактирование в выбранном вами текстовом редакторе.</p>
<p><img src="images/articles/barancev/wampserver/wamp_httpd_conf_1.png" border="0" alt="" /></p>
<p>Находим в нём строчку Listen 80 и меняем номер порта на какой-нибудь другой, желательно достаточно большой (по крайней мере больше 1024, так как все порты с меньшими номерами имеют "стандартные" назначения) и никем не занятый (проверьте это, используя netstat или TCPView, как описано выше). Например, указываем номер порта 8080.</p>
<p><img src="images/articles/barancev/wampserver/wamp_httpd_conf_2.png" border="0" alt="" width="622" height="260" /></p>
<p>Сохраняем файл, перезапускаем WampServer -- и на этот раз он таки должен позеленеть!</p>
<p>Единственное неудобство в этом случае заключается в том, что нестандартный номер порта придётся всегда указывать в адресе -- теперь ваш веб-сервер будет доступен по адресу <a href="http://localhost:8080/">http://localhost:8080/</a></p>
<p><img src="images/articles/barancev/wampserver/wamp_browser_8080.png" border="0" alt="" width="577" height="286" /></p>
<p><strong>F3. Иконка WampServer зелёная, но сайт в браузере не открывается.</strong></p>
<p>Возможные причины:</p>
<ul>
<li><span style="line-height: 1.3em;">система не знает, что означает сетевое имя localhost, либо</span></li>
<li><span style="line-height: 1.3em;"> в браузере указаны настройки прокси, которые не позволяют устанавливать соединения с локальным сервером.</span></li>
</ul>
<p>Чтобы исключить первую причину, попробуйте в адресе указать не сетевое имя, а IP-адрес: <a href="http://127.0.0.1/">http://127.0.0.1/</a> (или <a href="http://127.0.0.1:8080/">http://127.0.0.1:8080/</a> при использовании порта, отличного от стандартного).</p>
<p>Если получилось открыть приветственную страницу WampServer -- значит, проблема в том, что в файле hosts не описано сетевое имя localhost. Открываем в любом текстовом редакторе файл C:\windows\system32\drivers\etc\hosts и добавляем туда строчку</p>
<p>127.0.0.1 localhost</p>
<p><img src="images/articles/barancev/wampserver/hosts.png" border="0" alt="" width="564" height="379" /></p>
<p>После того, как это изменение внесено -- вновь пробуем использовать в адресе сетевое имя, то есть открываем в браузере адрес <a href="http://localhost/">http://localhost/</a>, теперь всё должно сработать правильно.</p>
<p>Вторая возможная причина, из-за которой даже по IP-адресу сервер не удаётся открыть -- настройки браузера, согласно которым все запросы направляются в прокси-сервер. Нужно сделать так, чтобы запросы на адрес 127.0.0.1 туда не отправлялись, а шли прямиком к нашему локальному веб-серверу.</p>
<p>Браузеры Internet Explorer и Chrome используют системные настройки прокси, вот так они должны выглядеть (стоит галочка "Не использовать прокси-сервер для локальных адресов"):</p>
<p><img src="images/articles/barancev/wampserver/proxy_settings_system.png" border="0" alt="" width="597" height="366" /></p>
<p>Браузер Firefox может иметь свои собственные настройки, отличные от системных, тогда нужно вписать адрес 127.0.0.1 в список исключений:</p>
<p><img src="images/articles/barancev/wampserver/proxy_settings_firefox.png" border="0" alt="" width="575" height="444" /></p>
<p>После этого браузер должен найти локальный сервер и открыть его приветственную страницу.</p>
<p><strong>Вот и всё, теперь уж точно сервер работает и можно переходить к установке приложений!</strong></p>
